Title: Редактирование файлов на удаленном хосте (в т.ч. конфигов с владельцем root)
Date: 2014-10-22 13:38
Tags: zed, zedrem, remote editing 
Category: IT
Author: Swasher
Slug: zedrem

Случается, что конфиги на удаленной машине требуют маштабного редактирования. Поправить несколько строк, конечно, 
удобнее "не отходя от кассы", с помощью nano или mcedit. Но тяжелый софт типа бакулы редактировать этими редакторами
проблематично.

Варианты.
-------------------------------

Решения, работающие по ssh типа Sublime+SFTP требуют возможности зайти на ssh под рутом, чтобы править конфиги
в /etc. А зайти под рутом - это целая процедура - нужно создать пароль рута, отредактировать /etc/sshd, а потом
не зыбыть все вернуть на место. И так каждый раз. Мне это не подошло.

Вариаций этого способа множество - WinSCP, Notepap++, etc. Есть еще способ rsub+Sublime, но для него, как я понял, 
нужен локальный ssh сервер.


Zed
-------------------------------

Решением стал онлайн-редактор Zed с открытым исходным кодом.

- Сайт - [zedapp.org](http://zedapp.org/)
- Github - [github.com/zedapp](https://github.com/zedapp)

У этого редактора есть фича, которая называется zedrem - [Zed remote editing tool](http://zedapp.org/features/edit-remote-files/) 

Сам редактор ставится в хром как приложение, или по старинке можно скачать и запускать как `exe`.

Подготовка сервера (один раз)
-----------------------------

1. Логинимся на удаленный сервер по ssh
2. Скачиваем zedrem

        ::::console
        $ curl http://get.zedapp.org | bash
        
    Эта команда определит текущую ОС и архитектуру и скачает zedrem в текущую директорию.

3. Переместим файл в удобное место, доступное через $PATH

        ::::console
        $ sudo mv zedrem /bin/
    
4. Чтобы иметь возможность открыть файл в своем окошке, Zed использует некий 'сервер'. Сервер этот может 
 быть как внешний (по отношению к хосту с редактируемым файлом), так и локальный. Внешний находится на серверах Zed.
 Он у меня не заработал - возможно, из-за NAT. Но локальный сервер работает чудесно. Правда - если и сервер и клиент
 находятся в одной сети, иначе - нужно маппить порт 7337.
 
Для запуска создаем маленький скриптик `sudo touch /usr/local/sbin/zed`:
 
    ::bash
    #!/bin/bash
    zedrem --server
    zedrem -u ws://<IP>:7337
 

Редактирование
-----------------

Заходим в нужную директорию, пишем `zed`, копирум полученную ссылку в Zed. Profit!
  
Если нужно редактировать систмные папки типа /etc, запускаем от рута - `sudo zed`. Конечно, при редактировании
права и владелец файлов изменяться не будут.

Кстати, сохраняться не нужно - сохранение происходит автоматически и постоянно. Как пишут авторы, "Save buttons are so '00s." :)
 
    
Shortcuts
---------------------------

Небольшая памятка о самых нужных шорткатах:

- Ctrl-Shift-O - Выбрать источник
- Ctrl-T - дерево файлов
- Ctrl-E - открыть файл 
- Ctrl-F - поиск
- Ctrl-, - настройки
- Ctrl-. - команды
- Ctrl-1,2,3 - сплиты (сразу несколько фалов)
- Ctrl-Q - выход
